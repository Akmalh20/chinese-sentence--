<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mandarin Learning: People + Place + Activity</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Sans+SC:wght@400;700&display=swap');
        
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #f8fafc;
        }
        .chinese-font {
            font-family: 'Ma Shan Zheng', cursive;
        }
        .drop-zone {
            min-height: 120px;
            transition: all 0.3s ease;
        }
        .word-card {
            cursor: pointer;
            transition: all 0.2s;
            user-select: none;
        }
        .word-card:hover {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-5xl mx-auto">
        <!-- Language Toggle -->
        <div class="flex justify-end mb-4">
            <div class="inline-flex rounded-lg border border-gray-200 bg-white p-1 shadow-sm">
                <button onclick="setLanguage('ms')" id="lang-ms" class="px-4 py-1 rounded-md text-sm font-bold bg-blue-600 text-white">Malay</button>
                <button onclick="setLanguage('en')" id="lang-en" class="px-4 py-1 rounded-md text-sm font-bold text-gray-500">English</button>
            </div>
        </div>

        <!-- Header -->
        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-5xl font-extrabold text-blue-900 mb-2">
                <span class="lang-text" data-ms="Belajar Mandarin!" data-en="Learn Mandarin!">Belajar Mandarin!</span>
            </h1>
            <p class="text-lg text-gray-600">
                <span class="lang-text" data-ms="Topik: Sekolah & Aktiviti Bersama" data-en="Topic: School & Group Activities">Topik: Sekolah & Aktiviti Bersama</span>
            </p>
        </header>

        <!-- Navigation -->
        <nav class="grid grid-cols-3 gap-2 md:gap-4 mb-8">
            <button onclick="showSection('formula')" id="nav-formula" class="nav-btn p-3 rounded-2xl bg-blue-600 text-white font-bold shadow-lg transition-all">
                <span class="block text-xl">üìã</span>
                <span class="text-xs md:text-sm lang-text" data-ms="Formula" data-en="Formula">Formula</span>
            </button>
            <button onclick="showSection('vocab')" id="nav-vocab" class="nav-btn p-3 rounded-2xl bg-white text-blue-600 font-bold shadow-md border border-blue-100 transition-all">
                <span class="block text-xl">üìñ</span>
                <span class="text-xs md:text-sm lang-text" data-ms="Kosa Kata" data-en="Vocabulary">Kosa Kata</span>
            </button>
            <button onclick="showSection('play')" id="nav-play" class="nav-btn p-3 rounded-2xl bg-white text-blue-600 font-bold shadow-md border border-blue-100 transition-all">
                <span class="block text-xl">üéÆ</span>
                <span class="text-xs md:text-sm lang-text" data-ms="Permainan" data-en="Game">Permainan</span>
            </button>
        </nav>

        <!-- 1. Formula Section -->
        <section id="section-formula" class="space-y-6">
            <div class="bg-white p-6 rounded-3xl shadow-xl border border-blue-50">
                <h2 class="text-2xl font-bold text-blue-800 mb-6 flex items-center">
                    <span class="lang-text" data-ms="Susunan Ayat" data-en="Sentence Structure">Susunan Ayat</span>
                </h2>
                
                <div class="flex flex-col md:flex-row items-stretch justify-between gap-2 text-center">
                    <div class="flex-1 bg-indigo-50 p-4 rounded-2xl border-b-4 border-indigo-400">
                        <div class="text-xs font-bold text-indigo-400 uppercase lang-text" data-ms="Orang" data-en="People">Orang</div>
                        <div class="text-lg font-bold">Students / ÂêåÂ≠¶‰ª¨</div>
                    </div>
                    <div class="flex items-center justify-center text-gray-300">Ôºã</div>
                    <div class="flex-1 bg-yellow-50 p-4 rounded-2xl border-b-4 border-yellow-400">
                        <div class="text-xs font-bold text-yellow-500 uppercase lang-text" data-ms="Di" data-en="At/In">Di</div>
                        <div class="text-lg font-bold">Âú® (z√†i)</div>
                    </div>
                    <div class="flex items-center justify-center text-gray-300">Ôºã</div>
                    <div class="flex-1 bg-green-50 p-4 rounded-2xl border-b-4 border-green-400">
                        <div class="text-xs font-bold text-green-500 uppercase lang-text" data-ms="Tempat" data-en="Place">Tempat</div>
                        <div class="text-lg font-bold lang-text" data-ms="Padang" data-en="Field">Padang</div>
                    </div>
                    <div class="flex items-center justify-center text-gray-300">Ôºã</div>
                    <div class="flex-1 bg-purple-50 p-4 rounded-2xl border-b-4 border-purple-400">
                        <div class="text-xs font-bold text-purple-500 uppercase lang-text" data-ms="Bersama" data-en="Together">Bersama</div>
                        <div class="text-lg font-bold">‰∏ÄÂêå (yƒ´ t√≥ng)</div>
                    </div>
                    <div class="flex items-center justify-center text-gray-300">Ôºã</div>
                    <div class="flex-1 bg-orange-50 p-4 rounded-2xl border-b-4 border-orange-400">
                        <div class="text-xs font-bold text-orange-500 uppercase lang-text" data-ms="Aktiviti" data-en="Activity">Aktiviti</div>
                        <div class="text-lg font-bold lang-text" data-ms="Bermain" data-en="Playing">Bermain</div>
                    </div>
                </div>

                <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-blue-50 p-5 rounded-2xl border-l-4 border-blue-500">
                        <h3 class="font-bold text-blue-800 mb-2 lang-text" data-ms="Kenapa Lokasi di Tengah?" data-en="Why is Place in the Middle?">Kenapa Lokasi di Tengah?</h3>
                        <p class="text-sm leading-relaxed text-gray-700 lang-text" 
                           data-ms="Dalam Mandarin, kita mesti beritahu DI MANA kita berada SEBELUM beritahu APA kita buat." 
                           data-en="In Mandarin, you must state WHERE you are BEFORE saying WHAT you are doing.">
                           Dalam Mandarin, kita mesti beritahu DI MANA kita berada SEBELUM beritahu APA kita buat.
                        </p>
                    </div>
                    <div class="bg-purple-50 p-5 rounded-2xl border-l-4 border-purple-500">
                        <h3 class="font-bold text-purple-800 mb-2 lang-text" data-ms="Fungsi '‰∏ÄÂêå' (yƒ´ t√≥ng)" data-en="The Function of '‰∏ÄÂêå' (yƒ´ t√≥ng)">Fungsi '‰∏ÄÂêå' (yƒ´ t√≥ng)</h3>
                        <p class="text-sm leading-relaxed text-gray-700 lang-text" 
                           data-ms="Ia bermaksud 'bersama-sama'. Ia sentiasa diletakkan betul-betul sebelum kata kerja (aktiviti)." 
                           data-en="It means 'together'. It is always placed directly before the verb (activity).">
                           Ia bermaksud 'bersama-sama'. Ia sentiasa diletakkan betul-betul sebelum kata kerja (aktiviti).
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 2. Vocab Section -->
        <section id="section-vocab" class="hidden grid grid-cols-2 md:grid-cols-3 gap-4">
            <!-- Cards generated via script for maintenance -->
        </section>

        <!-- 3. Play Section -->
        <section id="section-play" class="hidden">
            <div class="bg-white p-6 md:p-10 rounded-3xl shadow-2xl border-2 border-blue-50">
                <div class="mb-8 text-center">
                    <div id="game-mission-title" class="text-sm font-bold text-blue-400 uppercase tracking-widest mb-1 lang-text" data-ms="Misi Anda" data-en="Your Mission">Misi Anda</div>
                    <div id="mission-text" class="text-xl md:text-2xl font-bold text-gray-800 leading-tight"></div>
                </div>

                <div id="drop-zone" class="drop-zone bg-slate-50 border-4 border-dashed border-blue-200 rounded-3xl p-6 flex flex-wrap gap-3 justify-center items-center mb-10 transition-colors">
                    <!-- Drop area -->
                </div>

                <div id="word-bank" class="flex flex-wrap gap-3 justify-center mb-10">
                    <!-- Words -->
                </div>

                <div class="flex flex-col md:flex-row justify-center gap-4">
                    <button onclick="checkAnswer()" class="bg-blue-600 hover:bg-blue-700 text-white px-10 py-4 rounded-2xl font-bold shadow-lg transform active:scale-95 transition-all">
                        <span class="lang-text" data-ms="Semak Jawapan" data-en="Check Answer">Semak Jawapan</span>
                    </button>
                    <button onclick="resetGame()" class="bg-gray-100 hover:bg-gray-200 text-gray-600 px-10 py-4 rounded-2xl font-bold transform active:scale-95 transition-all">
                        <span class="lang-text" data-ms="Semula" data-en="Reset">Semula</span>
                    </button>
                </div>
                
                <div id="feedback" class="mt-8 text-center font-bold p-4 rounded-xl hidden"></div>
            </div>
        </section>
    </div>

    <!-- Victory Modal -->
    <div id="victory-modal" class="fixed inset-0 bg-blue-900/80 hidden flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-3xl p-8 max-w-sm w-full text-center shadow-2xl">
            <div class="text-6xl mb-4">‚≠ê</div>
            <h2 class="text-3xl font-bold text-blue-900 mb-2 lang-text" data-ms="Syabas!" data-en="Well Done!">Syabas!</h2>
            <p class="text-gray-500 mb-8 lang-text" data-ms="Ayat anda tepat!" data-en="Your sentence is perfect!">Ayat anda tepat!</p>
            <button onclick="nextLevel()" class="w-full bg-blue-600 text-white py-4 rounded-2xl font-bold shadow-lg hover:bg-blue-700 transition-all">
                <span class="lang-text" data-ms="Tahap Seterusnya" data-en="Next Level">Tahap Seterusnya</span>
            </button>
        </div>
    </div>

    <script>
        let currentLang = 'ms';
        let currentLevelIndex = 0;
        let selectedWords = [];

        const vocab = [
            {zh: "ËØæÂÆ§", py: "k√® sh√¨", ms: "Bilik Darjah", en: "Classroom", icon: "üè´"},
            {zh: "ËçâÂú∫", py: "c«éo ch«éng", ms: "Padang", en: "Field", icon: "üèÉ"},
            {zh: "ÁæΩÊØõÁêÉÂú∫", py: "y«î m√°o qi√∫ ch«éng", ms: "G. Badminton", en: "Badminton Court", icon: "üè∏"},
            {zh: "ÁØÆÁêÉÂú∫", py: "l√°n qi√∫ ch«éng", ms: "G. Bola Keranjang", en: "Basketball Court", icon: "üèÄ"},
            {zh: "È£üÂ†Ç", py: "sh√≠ t√°ng", ms: "Kantin", en: "Canteen", icon: "üçú"},
            {zh: "Âú®", py: "z√†i", ms: "di", en: "at/in", icon: "üìç"},
            {zh: "‰∏ÄÂêå", py: "yƒ´ t√≥ng", ms: "bersama-sama", en: "together", icon: "ü§ù"}
        ];

        const levels = [
            {
                ms: "Murid-murid sedang bersenam di padang bersama-sama.",
                en: "The students are exercising in the field together.",
                answer: ["ÂêåÂ≠¶‰ª¨", "Âú®", "ËçâÂú∫", "‰∏ÄÂêå", "ÂÅöÊó©Êìç"],
                words: [
                    {zh: "ÂêåÂ≠¶‰ª¨", py: "t√≥ng xu√© men"},
                    {zh: "Âú®", py: "z√†i"},
                    {zh: "ËçâÂú∫", py: "c«éo ch«éng"},
                    {zh: "‰∏ÄÂêå", py: "yƒ´ t√≥ng"},
                    {zh: "ÂÅöÊó©Êìç", py: "zu√≤ z«éo cƒÅo"}
                ]
            },
            {
                ms: "Saya dan kawan makan di kantin bersama-sama.",
                en: "My friend and I are eating in the canteen together.",
                answer: ["ÊàëÂíåÊúãÂèã", "Âú®", "È£üÂ†Ç", "‰∏ÄÂêå", "ÂêÉÈù¢"],
                words: [
                    {zh: "ÊàëÂíåÊúãÂèã", py: "w«í h√© p√©ng you"},
                    {zh: "Âú®", py: "z√†i"},
                    {zh: "È£üÂ†Ç", py: "sh√≠ t√°ng"},
                    {zh: "‰∏ÄÂêå", py: "yƒ´ t√≥ng"},
                    {zh: "ÂêÉÈù¢", py: "chƒ´ mi√†n"}
                ]
            },
            {
                ms: "Abang bermain bola di gelanggang bola keranjang bersama-sama.",
                en: "Big brother is playing ball in the basketball court together.",
                answer: ["Âì•Âì•", "Âú®", "ÁØÆÁêÉÂú∫", "‰∏ÄÂêå", "ÊâìÁêÉ"],
                words: [
                    {zh: "Âì•Âì•", py: "gƒì ge"},
                    {zh: "Âú®", py: "z√†i"},
                    {zh: "ÁØÆÁêÉÂú∫", py: "l√°n qi√∫ ch«éng"},
                    {zh: "‰∏ÄÂêå", py: "yƒ´ t√≥ng"},
                    {zh: "ÊâìÁêÉ", py: "d«é qi√∫"}
                ]
            }
        ];

        function setLanguage(lang) {
            currentLang = lang;
            document.querySelectorAll('.lang-text').forEach(el => {
                el.innerText = el.getAttribute(`data-${lang}`);
            });
            
            // UI Toggle Colors
            document.getElementById('lang-ms').className = lang === 'ms' ? "px-4 py-1 rounded-md text-sm font-bold bg-blue-600 text-white" : "px-4 py-1 rounded-md text-sm font-bold text-gray-500";
            document.getElementById('lang-en').className = lang === 'en' ? "px-4 py-1 rounded-md text-sm font-bold bg-blue-600 text-white" : "px-4 py-1 rounded-md text-sm font-bold text-gray-500";
            
            if (document.getElementById('section-vocab').classList.contains('hidden') === false) renderVocab();
            if (document.getElementById('section-play').classList.contains('hidden') === false) updateMissionText();
        }

        function showSection(section) {
            ['formula', 'vocab', 'play'].forEach(s => {
                document.getElementById(`section-${s}`).classList.toggle('hidden', s !== section);
                const navBtn = document.getElementById(`nav-${s}`);
                if (s === section) {
                    navBtn.className = "nav-btn p-3 rounded-2xl bg-blue-600 text-white font-bold shadow-lg transition-all scale-105";
                } else {
                    navBtn.className = "nav-btn p-3 rounded-2xl bg-white text-blue-600 font-bold shadow-md border border-blue-100 transition-all";
                }
            });

            if (section === 'vocab') renderVocab();
            if (section === 'play') initGame();
        }

        function renderVocab() {
            const container = document.getElementById('section-vocab');
            container.innerHTML = vocab.map(v => `
                <div class="bg-white p-5 rounded-3xl shadow-sm border-b-4 border-blue-200 text-center">
                    <div class="text-3xl mb-2">${v.icon}</div>
                    <div class="text-2xl font-bold chinese-font">${v.zh}</div>
                    <div class="text-blue-500 text-sm italic font-medium">${v.py}</div>
                    <div class="text-gray-400 text-xs mt-1 uppercase font-bold">${v[currentLang]}</div>
                </div>
            `).join('');
        }

        function initGame() {
            const level = levels[currentLevelIndex];
            updateMissionText();
            const wordBank = document.getElementById('word-bank');
            wordBank.innerHTML = '';
            
            // Shuffle
            const shuffled = [...level.words].sort(() => Math.random() - 0.5);
            shuffled.forEach(w => {
                const card = createCard(w);
                wordBank.appendChild(card);
            });

            document.getElementById('drop-zone').innerHTML = '';
            document.getElementById('feedback').classList.add('hidden');
            document.getElementById('drop-zone').classList.remove('border-red-200', 'bg-red-50');
            selectedWords = [];
        }

        function updateMissionText() {
            const level = levels[currentLevelIndex];
            document.getElementById('mission-text').innerText = level[currentLang];
        }

        function createCard(word) {
            const div = document.createElement('div');
            div.className = "word-card bg-white px-5 py-4 rounded-2xl shadow-md border-2 border-transparent text-center min-w-[100px]";
            div.innerHTML = `
                <div class="text-[10px] text-blue-400 font-bold italic mb-1">${word.py}</div>
                <div class="text-xl font-bold chinese-font text-gray-800">${word.zh}</div>
            `;
            div.onclick = () => handleCardInteraction(word, div);
            return div;
        }

        function handleCardInteraction(word, el) {
            const dropZone = document.getElementById('drop-zone');
            const wordBank = document.getElementById('word-bank');
            
            if (el.parentElement === wordBank) {
                dropZone.appendChild(el);
                selectedWords.push(word.zh);
            } else {
                wordBank.appendChild(el);
                selectedWords = selectedWords.filter(w => w !== word.zh);
            }
            document.getElementById('feedback').classList.add('hidden');
        }

        function checkAnswer() {
            const level = levels[currentLevelIndex];
            const feedback = document.getElementById('feedback');
            const dropZone = document.getElementById('drop-zone');

            if (selectedWords.length === 0) return;

            if (JSON.stringify(selectedWords) === JSON.stringify(level.answer)) {
                document.getElementById('victory-modal').classList.remove('hidden');
            } else {
                const msg = currentLang === 'ms' 
                    ? "Susunan salah. Ingat: Orang + Âú® + Tempat + ‰∏ÄÂêå + Aktiviti." 
                    : "Wrong order. Remember: People + Âú® + Place + ‰∏ÄÂêå + Activity.";
                feedback.innerText = "‚ùå " + msg;
                feedback.className = "mt-8 text-center font-bold p-4 rounded-xl text-red-600 bg-red-50 border border-red-100";
                feedback.classList.remove('hidden');
                dropZone.classList.add('border-red-200', 'bg-red-50');
            }
        }

        function resetGame() {
            initGame();
        }

        function nextLevel() {
            document.getElementById('victory-modal').classList.add('hidden');
            currentLevelIndex = (currentLevelIndex + 1) % levels.length;
            initGame();
        }

        // Initialize default view
        window.onload = () => setLanguage('ms');
    </script>
</body>
</html>

